{"id":"lCoFUiTn8lCoS5Ph3oFikb3RV2CN69EH","type":"flow","storageId":"ws-1737463822768Re8Ol1GKTIZzgx97T19QR","name":"Swarm","description":"Enhanced Swarm Orchestration with AG2. Based on: https://docs.ag2.ai/notebooks/agentchat_swarm_enhanced","tags":["Swarm","Swarm Orchestration"],"requirements":[],"createdAt":"2025-01-30T08:59:47.662Z","updatedAt":"2025-01-30T09:00:01.414Z","data":{"nodes":[{"id":"ws-1737463930044jcoPhuZPj6Lyqo8RUGpg_","type":"model","position":{"x":0,"y":10},"measured":{"width":182,"height":182},"selected":true,"hidden":true},{"id":"ws-17374644736302vMHYXfh8nEMPbFDQreJ4","type":"skill","position":{"x":0,"y":10},"measured":{"width":182,"height":182},"selected":false,"hidden":true},{"id":"ws-1737464497230vmxuubAq_AE8BKCxNmEdu","type":"skill","position":{"x":240,"y":10},"measured":{"width":182,"height":182},"selected":false,"hidden":true},{"id":"ws-1737464514743AgglkTDatghgKir-AbU2J","type":"skill","position":{"x":480,"y":10},"measured":{"width":182,"height":182},"selected":false,"hidden":true},{"id":"ws-1737464538674-E5IgEPn65joT0T9ePzIW","type":"skill","position":{"x":720,"y":10},"measured":{"width":182,"height":182},"selected":false,"hidden":true},{"id":"wa-1737464564552HWQESN71KMEkB_xXi9vUA","type":"agent","position":{"x":30,"y":420},"hidden":false,"measured":{"width":206,"height":214},"selected":false,"dragging":false},{"id":"wa-1737465140262mkc6Obn2EJeZZP7H5P1Bq","type":"agent","position":{"x":1425,"y":270},"hidden":false,"measured":{"width":206,"height":214},"selected":false,"dragging":false},{"id":"1737465169167Um3mttb3RBaDLvOz_bLv6","type":"agent","position":{"x":1410,"y":675},"hidden":false,"measured":{"width":206,"height":214},"selected":false,"dragging":false},{"id":"swarm-container-lCoFUiTn8lCoS5Ph3oFikb3RV2CN69EH","type":"agent","position":{"x":405,"y":180},"hidden":false,"measured":{"width":844,"height":804},"selected":false,"dragging":false,"width":844,"height":804,"resizing":false},{"id":"wa-1737464613697LWtjvtqVwetAROmysTjFf","type":"agent","position":{"x":60,"y":105},"parentId":"swarm-container-lCoFUiTn8lCoS5Ph3oFikb3RV2CN69EH","extent":"parent","hidden":false,"measured":{"width":206,"height":231},"selected":false,"dragging":false},{"id":"wa-1737464700312GpzAjDNowEhzbejk7ML0p","type":"agent","position":{"x":60,"y":480},"parentId":"swarm-container-lCoFUiTn8lCoS5Ph3oFikb3RV2CN69EH","extent":"parent","hidden":false,"measured":{"width":218,"height":214},"selected":false,"dragging":false},{"id":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","type":"agent","position":{"x":540,"y":105},"parentId":"swarm-container-lCoFUiTn8lCoS5Ph3oFikb3RV2CN69EH","extent":"parent","hidden":false,"measured":{"width":206,"height":231},"selected":false,"dragging":false}],"edges":[{"id":"we-1737464846794pRRpuXJ7-ZqB74z8sLVpv","source":"wa-1737464613697LWtjvtqVwetAROmysTjFf","target":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","hidden":false,"animated":false,"selected":false,"markerEnd":{"type":"arrowclosed","color":"#f0c808","width":10,"height":10},"style":{"stroke":"#f0c808","strokeWidth":3},"sourceHandle":"agent-handle-right-source-wa-1737464613697LWtjvtqVwetAROmysTjFf","targetHandle":"agent-handle-left-target-wa-1737464760717Rrum4lH4tQay0qvvxCmkN","type":"swarm"},{"id":"we-1737464916393QpJdYam692o0MK9Y3il9g","source":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","target":"wa-1737464613697LWtjvtqVwetAROmysTjFf","hidden":false,"animated":false,"selected":false,"markerEnd":{"type":"arrowclosed","color":"#f0c808","width":10,"height":10},"style":{"stroke":"#f0c808","strokeWidth":3},"sourceHandle":"agent-handle-left-source-wa-1737464760717Rrum4lH4tQay0qvvxCmkN","targetHandle":"agent-handle-right-target-wa-1737464613697LWtjvtqVwetAROmysTjFf","type":"swarm"},{"id":"we-1737464956357K2_QoBXyj1mJWDJ64nOVK","source":"wa-1737464613697LWtjvtqVwetAROmysTjFf","target":"wa-1737464700312GpzAjDNowEhzbejk7ML0p","hidden":false,"animated":false,"selected":false,"markerEnd":{"type":"arrowclosed","color":"#f0c808","width":10,"height":10},"style":{"stroke":"#f0c808","strokeWidth":3},"sourceHandle":"agent-handle-bottom-source-wa-1737464613697LWtjvtqVwetAROmysTjFf","targetHandle":"agent-handle-top-target-wa-1737464700312GpzAjDNowEhzbejk7ML0p","type":"swarm"},{"id":"we-1737464996743sNjMBj7h2HPGAZ3fxlst2","source":"wa-1737464700312GpzAjDNowEhzbejk7ML0p","target":"wa-1737464613697LWtjvtqVwetAROmysTjFf","hidden":false,"animated":false,"selected":false,"markerEnd":{"type":"arrowclosed","color":"#f0c808","width":10,"height":10},"style":{"stroke":"#f0c808","strokeWidth":3},"sourceHandle":"agent-handle-top-source-wa-1737464700312GpzAjDNowEhzbejk7ML0p","targetHandle":"agent-handle-bottom-target-wa-1737464613697LWtjvtqVwetAROmysTjFf","type":"swarm"},{"id":"we-17374650248984BtW9kakBGcm6noUXQIyQ","source":"wa-1737464564552HWQESN71KMEkB_xXi9vUA","target":"wa-1737464613697LWtjvtqVwetAROmysTjFf","hidden":false,"animated":false,"selected":false,"markerEnd":{"type":"arrowclosed","color":"#bc76f5","width":10,"height":10},"style":{"stroke":"#bc76f5","strokeWidth":3},"sourceHandle":"agent-handle-right-source-wa-1737464564552HWQESN71KMEkB_xXi9vUA","targetHandle":"agent-handle-left-target-wa-1737464613697LWtjvtqVwetAROmysTjFf","type":"swarm"},{"id":"we-1737465193705oxLOUncd3UZpzmaSnH9OS","source":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","target":"wa-1737465140262mkc6Obn2EJeZZP7H5P1Bq","hidden":false,"animated":true,"selected":false,"markerEnd":{"type":"arrowclosed","color":"#f0c808","width":10,"height":10},"style":{"stroke":"#f0c808","strokeWidth":3},"sourceHandle":"agent-handle-right-source-wa-1737464760717Rrum4lH4tQay0qvvxCmkN","targetHandle":"agent-handle-left-target-wa-1737465140262mkc6Obn2EJeZZP7H5P1Bq","type":"swarm"},{"id":"we-17374652364287v91q3jxNkSOXhhrzZdVJ","source":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","target":"1737465169167Um3mttb3RBaDLvOz_bLv6","hidden":false,"animated":true,"selected":false,"markerEnd":{"type":"arrowclosed","color":"#f0c808","width":10,"height":10},"style":{"stroke":"#f0c808","strokeWidth":3},"sourceHandle":"agent-handle-right-source-wa-1737464760717Rrum4lH4tQay0qvvxCmkN","targetHandle":"agent-handle-left-target-1737465169167Um3mttb3RBaDLvOz_bLv6","type":"swarm"},{"id":"we-1737465392639WGdlSoCaSBt0Ti_s3lngS","source":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","target":"wa-1737464700312GpzAjDNowEhzbejk7ML0p","hidden":false,"animated":false,"selected":false,"markerEnd":{"type":"arrowclosed","color":"#f0c808","width":10,"height":10},"style":{"stroke":"#f0c808","strokeWidth":3},"sourceHandle":"agent-handle-left-source-wa-1737464760717Rrum4lH4tQay0qvvxCmkN","targetHandle":"agent-handle-right-target-wa-1737464700312GpzAjDNowEhzbejk7ML0p","type":"swarm"}],"viewport":{"x":308,"y":-177.5,"zoom":1},"agents":{"users":[{"type":"agent","name":"customer","description":"customer","tags":[],"requirements":[],"createdAt":"2025-01-21T13:02:44.552Z","updatedAt":"2025-01-21T13:02:44.552Z","data":{"systemMessage":null,"humanInputMode":"ALWAYS","codeExecutionConfig":false,"agentDefaultAutoReply":null,"maxConsecutiveAutoReply":null,"termination":{"type":"none","keywords":[],"criterion":null,"methodContent":null},"modelIds":[],"skills":[],"parentId":null,"nestedChats":[]},"id":"wa-1737464564552HWQESN71KMEkB_xXi9vUA","agentType":"user"}],"assistants":[{"type":"agent","name":"order_summariser_agent","description":"You are an order summariser agent that provides a summary of the order details.","tags":[],"requirements":[],"createdAt":"2025-01-21T13:12:20.262Z","updatedAt":"2025-01-21T13:12:20.262Z","data":{"systemMessage":"You are an order summariser agent that provides a summary of the order details.","humanInputMode":"NEVER","codeExecutionConfig":false,"agentDefaultAutoReply":null,"maxConsecutiveAutoReply":null,"termination":{"type":"none","keywords":[],"criterion":null,"methodContent":null},"modelIds":["ws-1737463930044jcoPhuZPj6Lyqo8RUGpg_"],"skills":[],"parentId":null,"nestedChats":[]},"id":"wa-1737465140262mkc6Obn2EJeZZP7H5P1Bq","agentType":"assistant"},{"type":"agent","name":"order_retrieval_agent","description":"You are an order retrieval agent that gets details about an order.","tags":[],"requirements":[],"createdAt":"2025-01-21T13:12:20.262Z","updatedAt":"2025-01-21T13:12:20.262Z","data":{"systemMessage":"You are an order retrieval agent that gets details about an order.","humanInputMode":"NEVER","codeExecutionConfig":false,"agentDefaultAutoReply":null,"maxConsecutiveAutoReply":null,"termination":{"type":"none","keywords":[],"criterion":null,"methodContent":null},"modelIds":["ws-1737463930044jcoPhuZPj6Lyqo8RUGpg_"],"skills":[],"parentId":null,"nestedChats":[]},"id":"1737465169167Um3mttb3RBaDLvOz_bLv6","agentType":"assistant"}],"managers":[],"rag_users":[],"swarm_agents":[{"type":"agent","agentType":"swarm","name":"order_triage_agent","description":"order_triage_agent","tags":[],"requirements":[],"createdAt":"2025-01-21T13:03:33.697Z","updatedAt":"2025-01-21T13:03:33.697Z","data":{"systemMessage":null,"humanInputMode":"NEVER","codeExecutionConfig":false,"agentDefaultAutoReply":null,"maxConsecutiveAutoReply":null,"termination":{"type":"none","keywords":[],"criterion":null,"methodContent":null},"modelIds":["ws-1737463930044jcoPhuZPj6Lyqo8RUGpg_"],"skills":[],"parentId":null,"nestedChats":[],"functions":["ws-1737464497230vmxuubAq_AE8BKCxNmEdu","ws-1737464538674-E5IgEPn65joT0T9ePzIW"],"updateAgentStateBeforeReply":[{"updateFunctionType":"string","updateFunction":"You are an order triage agent, working with a customer and a group of agents to provide support for your e-commerce platform.\n\nAn agent needs to be logged in to be able to access their order. The authentication_agent will work with the customer to verify their identity, transfer to them to start with.\nThe order_mgmt_agent will manage all order related tasks, such as tracking orders, managing orders, etc. Be sure to check the order as one step. Then if it's valid you can record it in the context.\n\nAsk the customer for further information when necessary.\n\nThe current status of this workflow is:\nCustomer name: {customer_name}\nLogged in: {logged_in}\nEnquiring for Order ID: {order_id}"}],"handoffs":[{"targetType":"agent","target":{"id":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","order":0},"condition":"The customer is logged in, continue with the order triage.","available":{"type":"string","value":"logged_in"}},{"targetType":"agent","target":{"id":"wa-1737464700312GpzAjDNowEhzbejk7ML0p","order":0},"condition":"The customer is not logged in, authenticate the customer.","available":{"type":"string","value":"requires_login"}},{"recipientType":"option","recipient":"REVERT_TO_USER"}],"isInitial":true},"id":"wa-1737464613697LWtjvtqVwetAROmysTjFf","position":{"x":60,"y":105},"parentId":"swarm-container-lCoFUiTn8lCoS5Ph3oFikb3RV2CN69EH","extent":"parent","hidden":false,"measured":{"width":206,"height":231},"selected":false,"dragging":false},{"type":"agent","agentType":"swarm","name":"authentication_agent","description":"authentication_agent","tags":[],"requirements":[],"createdAt":"2025-01-21T13:05:00.312Z","updatedAt":"2025-01-21T13:05:00.312Z","data":{"systemMessage":null,"humanInputMode":"NEVER","codeExecutionConfig":false,"agentDefaultAutoReply":null,"maxConsecutiveAutoReply":null,"termination":{"type":"none","keywords":[],"criterion":null,"methodContent":null},"modelIds":["ws-1737463930044jcoPhuZPj6Lyqo8RUGpg_"],"skills":[],"parentId":null,"nestedChats":[],"functions":["ws-1737464514743AgglkTDatghgKir-AbU2J"],"updateAgentStateBeforeReply":[],"handoffs":[{"targetType":"agent","target":{"id":"wa-1737464613697LWtjvtqVwetAROmysTjFf","order":0},"condition":"The customer is logged in, continue with the order triage.","available":{"type":"string","value":"logged_in"}},{"recipientType":"option","recipient":"REVERT_TO_USER"}],"isInitial":false},"id":"wa-1737464700312GpzAjDNowEhzbejk7ML0p","position":{"x":60,"y":480},"parentId":"swarm-container-lCoFUiTn8lCoS5Ph3oFikb3RV2CN69EH","extent":"parent","hidden":false,"measured":{"width":218,"height":214},"selected":false,"dragging":false},{"type":"agent","agentType":"swarm","name":"order_mgmt_agent","description":"order_mgmt_agent","tags":[],"requirements":[],"createdAt":"2025-01-21T13:06:00.717Z","updatedAt":"2025-01-21T13:06:00.717Z","data":{"systemMessage":null,"humanInputMode":"NEVER","codeExecutionConfig":false,"agentDefaultAutoReply":null,"maxConsecutiveAutoReply":null,"termination":{"type":"none","keywords":[],"criterion":null,"methodContent":null},"modelIds":["ws-1737463930044jcoPhuZPj6Lyqo8RUGpg_"],"skills":[],"parentId":null,"nestedChats":[],"functions":["ws-1737464497230vmxuubAq_AE8BKCxNmEdu","ws-1737464538674-E5IgEPn65joT0T9ePzIW"],"updateAgentStateBeforeReply":[{"updateFunctionType":"string","updateFunction":"You are an order management agent that manages inquiries related to e-commerce orders.\n\nThe order must be logged in to access their order.\n\nUse your available tools to get the status of the details from the customer. Ask the customer questions as needed.\n\nThe current status of this workflow is:\nCustomer name: {customer_name}\nLogged in: {logged_in}\nEnquiring for Order ID: {order_id}"}],"handoffs":[{"target":{"id":"we-17374652364287v91q3jxNkSOXhhrzZdVJ","order":0},"targetType":"nested_chat","available":{"type":"callable","value":"\"\"\"Custom on condition availability check function.\"\"\"\n# provide the function to determine if the agent should be available\n# complete the `custom_on_condition_available` below. Do not change the name or the arguments of the function.\n# only complete the function body and the docstring and return a boolean.\n# example:\n#    def custom_on_condition_available(\n#    agent: Agent,\n#    message: Dict[str, Any],\n# ) -> bool:\n#    return message.get(\"agent_name\", \"\") == agent.name\n#\ndef custom_on_condition_available(\n    agent: ConversableAgent,\n    message: Dict[str, Any],\n) -> bool:\n    \"\"\"Complete the on condition availability check function\"\"\"\n    return agent.get_context(\"has_order_id\") is True\n"},"condition":"Retrieve the status of the order."},{"targetType":"agent","target":{"id":"wa-1737464613697LWtjvtqVwetAROmysTjFf","order":0},"condition":"The customer has no more enquiries about this order.","available":{"type":"none","value":null}},{"targetType":"agent","target":{"id":"wa-1737464700312GpzAjDNowEhzbejk7ML0p","order":0},"condition":"The customer is not logged in, authenticate the customer.","available":{"type":"string","value":"requires_login"}},{"recipientType":"option","recipient":"REVERT_TO_USER"}],"isInitial":false},"id":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","position":{"x":540,"y":105},"parentId":"swarm-container-lCoFUiTn8lCoS5Ph3oFikb3RV2CN69EH","extent":"parent","hidden":false,"measured":{"width":206,"height":231},"selected":false,"dragging":false}],"reasoning_agents":[]},"models":[{"id":"ws-1737463930044jcoPhuZPj6Lyqo8RUGpg_","type":"model","name":"gpt-4-turbo","description":"gpt-4-turbo","tags":[],"requirements":[],"createdAt":"2025-01-21T12:52:10.044Z","updatedAt":"2025-01-21T22:21:20.867Z","data":{"apiKey":"REPLACE_ME","apiType":"openai","apiVersion":null,"baseUrl":null,"temperature":null,"topP":null,"maxTokens":null,"defaultHeaders":{},"price":{"promptPricePer1k":null,"completionTokenPricePer1k":null}}}],"skills":[{"id":"ws-17374644736302vMHYXfh8nEMPbFDQreJ4","type":"skill","name":"waldiez_shared","description":"Global storage with user and order database.","tags":[],"requirements":[],"createdAt":"2025-01-21T13:01:13.630Z","updatedAt":"2025-01-21T13:01:28.511Z","data":{"content":"# Databases\n\nUSER_DATABASE = {\n    \"mark\": {\n        \"full_name\": \"Mark Sze\",\n    },\n    \"kevin\": {\n        \"full_name\": \"Yiran Wu\",\n    },\n}\n\nORDER_DATABASE = {\n    \"TR13845\": {\n        \"user\": \"mark\",\n        \"order_number\": \"TR13845\",\n        \"status\": \"shipped\",  # order status: order_received, shipped, delivered, return_started, returned\n        \"return_status\": \"N/A\",  # return status: N/A, return_started, return_shipped, return_delivered, refund_issued\n        \"product\": \"matress\",\n        \"link\": \"https://www.example.com/TR13845\",\n        \"shipping_address\": \"123 Main St, State College, PA 12345\",\n    },\n    \"TR14234\": {\n        \"user\": \"kevin\",\n        \"order_number\": \"TR14234\",\n        \"status\": \"delivered\",\n        \"return_status\": \"N/A\",\n        \"product\": \"pillow\",\n        \"link\": \"https://www.example.com/TR14234\",\n        \"shipping_address\": \"123 Main St, State College, PA 12345\",\n    },\n    \"TR29384\": {\n        \"user\": \"mark\",\n        \"order_number\": \"TR29384\",\n        \"status\": \"delivered\",\n        \"return_status\": \"N/A\",\n        \"product\": \"bed frame\",\n        \"link\": \"https://www.example.com/TR29384\",\n        \"shipping_address\": \"123 Main St, State College, PA 12345\",\n    },\n}\n","secrets":{}}},{"id":"ws-1737464497230vmxuubAq_AE8BKCxNmEdu","type":"skill","name":"record_order_id","description":"record_order_id","tags":[],"requirements":[],"createdAt":"2025-01-21T13:01:37.230Z","updatedAt":"2025-01-21T13:01:45.493Z","data":{"content":"# filename: {new_skill}.py\n\"\"\"Replace this with your code.\n\nmake sure a function with the same name\nas the skill is defined in the code.\n\"\"\"\nfrom autogen import SwarmResult\n\n\ndef record_order_id(order_id: str, context_variables: dict) -> SwarmResult:\n    \"\"\"Record the order ID in the workflow context\"\"\"\n    if order_id not in ORDER_DATABASE:\n        return SwarmResult(\n            context_variables=context_variables,\n            values=f\"Order ID {order_id} not found. Please ask for the correct order ID.\",\n        )\n\n    context_variables[\"order_id\"] = order_id\n    context_variables[\"has_order_id\"] = True\n    return SwarmResult(\n        context_variables=context_variables, values=f\"Order ID Recorded: {order_id}\",\n    )\n","secrets":{}}},{"id":"ws-1737464514743AgglkTDatghgKir-AbU2J","type":"skill","name":"login_customer_by_username","description":"login_customer_by_username","tags":[],"requirements":[],"createdAt":"2025-01-21T13:01:54.744Z","updatedAt":"2025-01-21T13:02:06.326Z","data":{"content":"# filename: {new_skill}.py\n\"\"\"Replace this with your code.\n\nmake sure a function with the same name\nas the skill is defined in the code.\n\"\"\"\nfrom autogen import SwarmResult\n\ndef login_customer_by_username(username: str, context_variables: dict) -> SwarmResult:\n    \"\"\"Get and log the customer in by their username\"\"\"\n    if username in USER_DATABASE:\n        context_variables[\"customer_name\"] = USER_DATABASE[username][\"full_name\"]\n        context_variables[\"logged_in_username\"] = username\n        context_variables[\"logged_in\"] = True\n        context_variables[\"requires_login\"] = False\n        return SwarmResult(\n            context_variables=context_variables,\n            values=f\"Welcome back our customer, {context_variables['customer_name']}! Please continue helping them.\",\n        )\n    else:\n        return SwarmResult(\n            context_variables=context_variables,\n            values=f\"User {username} not found. Please ask for the correct username.\",\n        )","secrets":{}}},{"id":"ws-1737464538674-E5IgEPn65joT0T9ePzIW","type":"skill","name":"check_order_id","description":"check_order_id","tags":[],"requirements":[],"createdAt":"2025-01-21T13:02:18.674Z","updatedAt":"2025-01-21T13:02:28.199Z","data":{"content":"# filename: {new_skill}.py\n\"\"\"Replace this with your code.\n\nmake sure a function with the same name\nas the skill is defined in the code.\n\"\"\"\n\nfrom autogen import SwarmResult\n\n\ndef check_order_id(order_id: str, context_variables: dict) -> SwarmResult:\n    \"\"\"Check if the order ID is valid\"\"\"\n    # Restricts order to checking to the logged in user\n    if (\n        context_variables[\"logged_in_username\"]\n        and order_id in ORDER_DATABASE\n        and ORDER_DATABASE[order_id][\"user\"] == context_variables[\"logged_in_username\"]\n    ):\n        return SwarmResult(\n            context_variables=context_variables, values=f\"Order ID {order_id} is valid.\",\n        )\n    else:\n        return SwarmResult(\n            context_variables=context_variables,\n            values=f\"Order ID {order_id} is invalid. Please ask for the correct order ID.\",\n        )","secrets":{}}}],"chats":[{"id":"we-1737464846794pRRpuXJ7-ZqB74z8sLVpv","data":{"source":"wa-1737464613697LWtjvtqVwetAROmysTjFf","target":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","name":"HandleEnquiry","order":-1,"description":"The customer is logged in, continue with the order triage.","position":0,"clearHistory":true,"maxTurns":null,"message":{"type":"none","content":null,"context":{},"use_carryover":false},"summary":{"method":"last_msg","prompt":"","args":{}},"nestedChat":{"message":null,"reply":null},"prerequisites":[],"maxRounds":20,"afterWork":null,"flowAfterWork":null,"available":{"type":"string","value":"logged_in"},"contextVariables":{},"realSource":null,"realTarget":null}},{"id":"we-1737464916393QpJdYam692o0MK9Y3il9g","data":{"source":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","target":"wa-1737464613697LWtjvtqVwetAROmysTjFf","name":"Done","order":-1,"description":"The customer has no more enquiries about this order.","position":1,"clearHistory":true,"maxTurns":null,"message":{"type":"none","content":null,"context":{},"use_carryover":false},"summary":{"method":"last_msg","prompt":"","args":{}},"nestedChat":{"message":null,"reply":null},"prerequisites":[],"maxRounds":20,"afterWork":null,"flowAfterWork":null,"available":{"type":"none","value":null},"contextVariables":{},"realSource":null,"realTarget":"wa-1737464613697LWtjvtqVwetAROmysTjFf"}},{"id":"we-1737464956357K2_QoBXyj1mJWDJ64nOVK","data":{"source":"wa-1737464613697LWtjvtqVwetAROmysTjFf","target":"wa-1737464700312GpzAjDNowEhzbejk7ML0p","name":"NotAuthenticated","order":-1,"description":"The customer is not logged in, authenticate the customer.","position":2,"clearHistory":true,"maxTurns":null,"message":{"type":"none","content":null,"context":{},"use_carryover":false},"summary":{"method":"last_msg","prompt":"","args":{}},"nestedChat":{"message":null,"reply":null},"prerequisites":[],"maxRounds":20,"afterWork":null,"flowAfterWork":null,"available":{"type":"string","value":"requires_login"},"contextVariables":{},"realSource":null,"realTarget":null}},{"id":"we-1737464996743sNjMBj7h2HPGAZ3fxlst2","data":{"source":"wa-1737464700312GpzAjDNowEhzbejk7ML0p","target":"wa-1737464613697LWtjvtqVwetAROmysTjFf","name":"IsAuthenticated","order":-1,"description":"The customer is logged in, continue with the order triage.","position":3,"clearHistory":true,"maxTurns":null,"message":{"type":"none","content":null,"context":{},"use_carryover":false},"summary":{"method":"last_msg","prompt":"","args":{}},"nestedChat":{"message":null,"reply":null},"prerequisites":[],"maxRounds":20,"afterWork":null,"flowAfterWork":null,"available":{"type":"string","value":"logged_in"},"contextVariables":{},"realSource":null,"realTarget":null}},{"id":"we-17374650248984BtW9kakBGcm6noUXQIyQ","data":{"source":"wa-1737464564552HWQESN71KMEkB_xXi9vUA","target":"wa-1737464613697LWtjvtqVwetAROmysTjFf","name":"Start","order":-1,"description":"Transfer to order_triage_agent","position":4,"clearHistory":true,"maxTurns":null,"message":{"type":"string","content":"Help me with my order.","context":{},"use_carryover":false},"summary":{"method":"last_msg","prompt":"","args":{}},"nestedChat":{"message":null,"reply":null},"prerequisites":[],"maxRounds":40,"afterWork":{"recipientType":"option","recipient":"REVERT_TO_USER"},"flowAfterWork":{"recipientType":"option","recipient":"REVERT_TO_USER"},"available":{"type":"none","value":null},"contextVariables":{"customer_name":"none","logged_in_username":"none","logged_in":"false","requires_login":"true","has_order_id":"false","order_id":"none"},"realSource":null,"realTarget":"wa-1737464613697LWtjvtqVwetAROmysTjFf"}},{"id":"we-1737465193705oxLOUncd3UZpzmaSnH9OS","data":{"source":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","target":"wa-1737465140262mkc6Obn2EJeZZP7H5P1Bq","name":"GetOrderStatus","order":-1,"description":"Transfer to order_summariser_agent","position":5,"clearHistory":true,"maxTurns":1,"message":{"type":"none","content":null,"context":{},"use_carryover":false},"summary":{"method":"last_msg","prompt":"","args":{}},"nestedChat":{"message":{"type":"string","use_carryover":false,"content":"Summarise the order details provided in a tabulated, text-based, order sheet format.","context":{}},"reply":{"type":"none","use_carryover":false,"content":null,"context":{}}},"prerequisites":[],"maxRounds":20,"afterWork":null,"flowAfterWork":null,"available":{"type":"none","value":null},"contextVariables":{},"realSource":null,"realTarget":null}},{"id":"we-17374652364287v91q3jxNkSOXhhrzZdVJ","data":{"source":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","target":"1737465169167Um3mttb3RBaDLvOz_bLv6","name":"GetOrderStatus","order":-1,"description":"Transfer to order_retrieval_agent","position":6,"clearHistory":true,"maxTurns":1,"message":{"type":"none","content":null,"context":{},"use_carryover":false},"summary":{"method":"last_msg","prompt":"","args":{}},"nestedChat":{"message":{"type":"method","use_carryover":false,"content":"\"\"\"Custom nested chat message function.\"\"\"\n# provide the message to be sent from the sender to the recipient in a nested chat\n# complete the `nested_chat_message` below. Do not change the name or the arguments of the function.\n# only complete the function body and the docstring and return the final message.\n# example:\n# def nested_chat_message(recipient, messages, sender, config):\n#    # type: (ConversableAgent, Optional[list[dict]], Optional[ConversableAgent], Optional[dict]) -> str | dict\n#    return f\"\"\"Review the following content.\n#            \\n\\n {recipient.chat_messages_for_summary(sender)[-1]['content']}\"\"\"\n#\ndef nested_chat_message(recipient, messages, sender, config):\n    \"\"\"Extract the order summary based on the OrderID in the context variables\"\"\"\n    order_id = sender.get_context(\"order_id\")\n    if order_id and order_id in ORDER_DATABASE:\n        order = ORDER_DATABASE[order_id]\n        return f\"Order {order['order_number']} for {order['product']} is currently {order['status']}. The shipping address is {order['shipping_address']}.\"\n    else:\n        return f\"Order {order_id} not found.\"\n","context":{}},"reply":{"type":"none","use_carryover":false,"content":null,"context":{}}},"prerequisites":[],"maxRounds":20,"afterWork":null,"flowAfterWork":null,"available":{"type":"none","value":null},"contextVariables":{},"realSource":null,"realTarget":null}},{"id":"we-1737465392639WGdlSoCaSBt0Ti_s3lngS","data":{"source":"wa-1737464760717Rrum4lH4tQay0qvvxCmkN","target":"wa-1737464700312GpzAjDNowEhzbejk7ML0p","name":"NotAuthenticated","order":-1,"description":"The customer is not logged in, authenticate the customer.","position":7,"clearHistory":true,"maxTurns":null,"message":{"type":"none","content":null,"context":{},"use_carryover":false},"summary":{"method":"last_msg","prompt":"","args":{}},"nestedChat":{"message":null,"reply":null},"prerequisites":[],"maxRounds":20,"afterWork":null,"flowAfterWork":null,"available":{"type":"string","value":"requires_login"},"contextVariables":{},"realSource":null,"realTarget":null}}],"isAsync":false}}